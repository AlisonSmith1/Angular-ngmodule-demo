<div>
  <div class="card2">
    <div class="fleet-tracking">
      <div class="header-section">
        <h3>FLEET & ASSET TRACKING</h3>
        <div class="badge">LIVE</div>
      </div>

      <div class="map-container">
        @if (apiLoaded$ | async) {
        <google-map
          height="100%"
          width="100%"
          [center]="center"
          [zoom]="zoom"
          [options]="mapOptions"
        >
          @for (driver of locations; track driver.id) {
          <map-advanced-marker
            #marker="mapAdvancedMarker"
            [position]="{ lat: driver.lat, lng: driver.lng }"
          >
          </map-advanced-marker>
          }

          <map-info-window #infoWindow="mapInfoWindow">
            @if (selectedDriver) {
            <div class="map-info-card">
              <header>
                <span class="driver-name">{{ selectedDriver.driverName }}</span>
                <span class="status-dot" [class]="selectedDriver.status"></span>
              </header>
              <main>
                <div class="info-row">
                  <span class="label">Vehicle:</span>
                  <span class="val">{{ selectedDriver.vehicleId }}</span>
                </div>
                <div class="info-row">
                  <span class="label">Speed:</span>
                  <span class="val">{{ selectedDriver.speed | number : '1.0-0' }} km/h</span>
                </div>
                <div class="info-row">
                  <span class="label">Status:</span>
                  <span class="val">{{ selectedDriver.status }}</span>
                </div>
              </main>
            </div>
            }
          </map-info-window>
        </google-map>
        } @else {
        <div class="map-loading">Radar System Initializing...</div>
        }
      </div>
    </div>
  </div>
</div>
